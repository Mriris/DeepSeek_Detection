# VULNEX - 技术实现文档

VULNEX 系统结合了深度学习和静态代码分析，用于检测二进制文件中的潜在安全漏洞。以下是项目中主要的 Python 脚本及其技术实现。

## 1. `app.py`
该代码是 VULNEX 的 Flask Web 应用，提供了前端接口用于文件上传、漏洞检测和分析结果展示。

### 功能：
- **文件上传和处理**：支持 `.bin`、`.exe`、`.elf` 格式的二进制文件上传。文件上传后，将执行特定的 IDA 脚本来提取特征数据并进行漏洞扫描。
- **漏洞检测**：集成了 VULNEX 模型扫描和 DeepSeek 模型分析，扫描二进制文件中的潜在漏洞，并返回详细的漏洞信息。
- **结果展示**：将检测到的漏洞及相关修复建议通过 Flask Web 页面展示给用户。

### 主要流程：
1. 用户上传二进制文件。
2. 文件被保存并通过 IDA 执行 `extract_features.py` 提取特征数据。
3. 使用 VULNEX 模型进行漏洞扫描。
4. 将扫描结果与提取的函数信息结合，通过 DeepSeek 生成最终的漏洞分析报告，并展示给用户。

### 依赖：
- `Flask`：Web 框架。
- `ollama`：用于与 DeepSeek 深度学习模型进行交互，分析漏洞的严重性。
- `IDA Pro 9.0`：用于执行 IDA 命令。

## 2. `extract_features.py`
该脚本用于从二进制文件中提取函数和指令信息，依赖于 IDA Pro 进行逆向工程分析。

### 功能：
- **提取函数信息**：遍历二进制文件中的所有函数，获取函数名、起始地址和结束地址。
- **提取指令信息**：针对每个函数，提取其内部的汇编指令及对应地址。
- **保存为 JSON**：将提取的函数信息和指令数据以 JSON 格式保存，便于后续处理和分析。

### 主要函数：
- `extract_function_info()`：获取所有函数的基本信息（名称、起始地址、结束地址）及其指令。
- `extract_instructions()`：获取特定函数的汇编指令。
- `save_as_json()`：将提取的数据保存为 JSON 文件。

### 依赖：
- IDA Pro 的 API（`idautils`, `idc`）：进行二进制文件分析。


## 3. `process_vulfi.py`
处理扫描结果，提取并格式化漏洞数据。

### 功能：
- **读取 VULNEX 结果**：读取 CSV 格式的 VULNEX 扫描结果，处理并提取有用的数据。
- **格式化指令**：对提取的指令进行格式化，去除多余的空格，确保数据一致性。
- **提取并整合漏洞数据**：将扫描结果与提取的函数指令进行匹配，按优先级排序生成最终的漏洞分析数据。

### 主要函数：
- `read_vulfi_file()`：读取 VULNEX 找到的漏洞结果并返回一个字典数组。
- `read_extracted_functions()`：读取从 `extract_features.py` 中提取的函数数据。
- `extract_vulfi_data()`：根据扫描结果和提取的函数数据生成漏洞上下文。

### 依赖：
- `CSV` 和 `JSON` 模块：用于数据读取和保存。


